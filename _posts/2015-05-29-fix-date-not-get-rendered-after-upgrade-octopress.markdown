---
layout: post
title: "Fix Date Issue"
date: 2015-05-29 10:05:04 +1000
comments: true
header-img: "img/post-bg-08.jpg"
categories: [octopress, blogging]
reading_time: "10 mins"
---

Recently when I upgrade the octopress I found the date for post isn't properly rendered. Then I decided to sit down to
spend some time fixing this issue, it turns out to be a very interesting one. I put all of my debug traces here to remind
me this journey.

<!--more-->

My problem is the date for post doesn't get rendered. <br>
And when I inspects the relevant source code it shows the time tag only with something like this `<time datetime="2014-12-30T06:30:00+01:00" pubdate data-updated="true"></time>`. So where is actually date text ?

------------------------

The first thing occurred to my mind is probably I screwed up some date formats so that octopress magic date rendering function can't parse the customized date format ?
So I go to [strfti.me](http://www.strfti.me/) to validate my date formats. After trying a few combination, get added to
`_config.yml` with something like `date_format: "%Y-%m-%d"`, no luck.
So, date format is ok, maybe I don't get the liquid templating right ? After all, octopress is built on top of Jekyll, and
Jekyll uses the liquid for rendering.

After a few searches, I figure out that the actual rendering work for post date is done in `date.html`. Which, is in a
chain of `include` with the path: `index.html -> article.html -> date.html`.
So the **time** is there, actually it's generated by `date.html`, get parsed in `article.html`. But why it's missing after `rake generate` ?
{% gist 4a396d183fd1cc1e7451 article.html %}
So I do a diff between my previous working version and current one for `article.html`:
{% gist 4a396d183fd1cc1e7451 diff_for_article.diff %}
Well, it's almost the same except for some irrelevant css stuff.
So Could it be the problem with the `date.html` shipped with new octopress version ?

Alright, the `date.html` is full of liquid templating which almost makes no sense to me. What should I do ? Hmm, doing a diff with previous working version is still a good start:
{% gist 4a396d183fd1cc1e7451 date.html %}
It's the same ! But this is the file responsible for showing the time ! what am I missing here ? <br>
Could it be the change of API in Jekyll for date formatting ? I go to the [Jekyll docs](http://jekyllrb.com/docs/templates/) to check the `date_to_xmlschema`, everything seems fine.
However, when I check the [octopress docs](https://github.com/octopress/date-format), I found something called `post.date_time_html` mentioned there which doesn't appear in our `date.html` at all! <br>
According to the docs, using `post.date_time_html` will render the following html:
{% gist 4a396d183fd1cc1e7451 post.date_time_html.html %}
All those `spans` are exactly what I'm looking for ! <br>
So using these two lines solve my issue, holy cow !
{% gist 4a396d183fd1cc1e7451 fix_post_date_time %}

The issue has already been patched with this commit by octopress [patch](https://github.com/imathis/octopress/commit/73e540409ceb8bc18048b6a96a4b815fc303ea28)
{% gist 4a396d183fd1cc1e7451 patch.diff %}
Now, my post date gets back :)
